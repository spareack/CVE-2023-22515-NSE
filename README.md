# CVE-2023-22515-NSE

Vulnerability checking tool via Nmap Scripting Engine

#### 1. –ü–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –∏ –æ–ø–∏—Å–∞—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã (–º–µ—Ö–∞–Ω–∏–∑–º—ã) —Ä–∞–±–æ—Ç—ã —É—è–∑–≤–∏–º–æ—Å—Ç–∏ CVE-2023-22515 –¥–ª—è Atlassian Confluence Server.

1. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∏–∑–º–µ–Ω—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ—Ä–≤–µ—Ä–∞, –æ—Ç–ø—Ä–∞–≤–ª—è—è –∑–∞–ø—Ä–æ—Å –Ω–∞ —É—è–∑–≤–∏–º—ã–π
   endpoint: `bootstrapStatusProvider.applicationConfig.setupComplete=false`
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `/setup/setupadministrator.action`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å
   –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
3. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ `/rest/api/user?username={username}` –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –≤—Å–µ –ª–æ–º–∞—Ç—å.

#### 2. –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å NSE —Å–∫—Ä–∏–ø—Ç –¥–ª—è NMap, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑–∞–ª –Ω–∞–ª–∏—á–∏–µ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—ã—à–µ—É–ø–æ–º—è–Ω—É—Ç–æ–π —É–∑—è–≤–∏–º–æ—Å—Ç–∏.

–°–∫—Ä–∏–ø—Ç —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–µ script.nse.
–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è/–æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–∏, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—É—Ç–µ–º:

1. –°–≤–µ—Ä–∫–∏ –≤–µ—Ä—Å–∏–∏ –ü–û.
2. –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –∫ —É—è–∑–≤–∏–º—ã–º —Ä–æ—É—Ç–∞–º.

#### 3. –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å–∫—Ä–∏–ø—Ç–∞.

* –ü—Ä–æ—Å—Ç–æ–≥–æ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, vds —Å –≥–∏–≥–æ–º –æ–ø–µ—Ä–∞—Ç–∏–≤–∫–∏ –Ω–µ –ø–æ—Ç—è–Ω—É–ª –∫–æ–Ω—Ñ–ª—é–µ–Ω—Å (
* –º–æ–≥—É –≤–∞–º –ø–æ—Ä—Ç –ø—Ä–æ–∫–∏–Ω—É—Ç—å `ssh -R localhost:8090:localhost:8090 user@server` üòà
* –Ω—É –ª–∏–±–æ —Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ —É —Å–µ–±—è 
* –Ω—É –ª–∞–¥–Ω–æ –º–æ–≥—É –∫–∏–Ω—É—Ç—å –∫—Ä–µ–¥—ã –æ—Ç vds –∏ —Ç—É–¥–∞ –ø–æ—Ä—Ç –ø—Ä–æ–∫–∏–Ω—É—Ç—å 

#### 4. –ü–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å–∏—Å—Ç–µ–º—ã –ø–æ–∑–≤–æ–ª–∏–ª–∏ –±—ã –µ–º—É ‚Äú—Å–∫—Ä—ã—Ç—å‚Äù —Ñ–∞–∫—Ç –Ω–∞–ª–∏—á–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏.

–ù—É –≤–æ—Ç —Ç—É—Ç –µ—Å—Ç—å —Ç–æ–ø 5 –º–µ—Å—Ç –æ—Ç–∫—É–¥–∞ –º–æ–∂–Ω–æ —Å–∫—Ä—ã—Ç—å –≤–µ—Ä—Å–∏—é —Å–µ—Ä–≤–∞–∫–∞ (–µ—Å–ª–∏ —è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–Ω—è–ª –≤–æ–ø—Ä–æ—Å):
https://confluence.atlassian.com/confkb/how-to-hide-version-information-on-confluence-980460833.html

* Login page footer.
* Response Head AJS Tags.
* Response Body What's New Link.
* Response Body Confluence Help Link.
* About Confluence Link
